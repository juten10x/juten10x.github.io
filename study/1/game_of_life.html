<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ライフゲーム</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap');
body {
  margin: 3% 5% 5% 5%;
}
pre {
  color: blue;
  font-family: 'Fira Code';
  overflow: auto;
}
#select {
  float: right;
  width: 50%
}
#main {
  float: left;
  width: 50%
}
#board { font-size: 90% }
#breadcrumbs { font-size: 90% }
</style>
<script>
"use strict";

let g = 0, dt = 500, a = [], b = [];
let t = 0;

/*
function check() {
  dt = document.getElementById('change_duration').value;
}
*/

function draw() {
  let s = '';
  for (let i = 1; i <= 25; i++) {
    for (let j = 1; j <= 40; j++) {
      let k = i * 41 + j;
      if (a[k])
        s += 'o';
      else
        s += ' ';
    }
    s += '\n';
  }
  s += "Generation: " + g;
  document.getElementById("board").textContent = s;
}

function update() {
  //dt = document.getElementById('change_duration').value;
  g++;

  for (let i = 1; i <= 25; i++) {
    for (let j = 1; j <= 40; j++) {
      let k = i * 41 + j;
      if (a[k]) {
        b[k-42]++; b[k-41]++; b[k-40]++;
        b[k- 1]++;            b[k+ 1]++;
        b[k+40]++; b[k+41]++; b[k+42]++;
      }
    }
  }
  for (let k = 0; k < 26 * 40 + 42; k++) {
    if (b[k] != 2) a[k] = (b[k] == 3);
    b[k] = 0;
  }
  draw();
}

for (let k = 0; k < 26 * 40 + 42; k++) {
  a[k] = false; b[k] = 0;
}

a[13*41+25] = true;
a[12*41+25] = true;
a[14*41+25] = true;
a[13*41+24] = true;
a[12*41+26] = true;

function auto() {
  draw();
  setInterval(update, dt);
}

//window.addEventListener('DOMContentLoaded', draw);
</script>
</head>
<body>

<div id="select">
<nav id="breadcrumbs">
<a href="../../">ホーム</a> &gt;
<a href="../">study</a> &gt;
<a href="./">1</a> &gt;
</nav>

<h2>ライフゲーム (<a href="https://ja.wikipedia.org/wiki/?curid=16010">Wikipedia</a>)</h2>

<label>手動:&nbsp;
<input type="button" value="Start" onclick="draw()">
<input type="button" value="Next" onclick="update()">
</label><br>
<label>自動:&nbsp;
<input type="button" value="Start" onclick="auto()">
<br><span>&nbsp;&nbsp;間隔を選択 (既定値: 500):</span>
<input type="button" value="10" onclick="dt = 10">
<input type="button" value="100" onclick="dt = 100">
<input type="button" value="500" onclick="dt = 500">
<input type="button" value="1000" onclick="dt = 1000">
</label>
</div>

<div id="main">
<pre id="board"></pre>
</div>

</body>
</html>
